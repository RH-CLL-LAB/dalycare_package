clean_RKKP_LYFO_snomed = function(data, snomed){
  ## clean_RKKP_LYFO_snomed translates Reg_WHOHistologikode1 and Reg_WHOHistologikode2 into ICD10
  data %>% 
    mutate(SUBTYPE_icd10 = recode_factor({{snomed}}, 
                                            `9590` = 'DC859',
                                            `9591`=	'DC857',
                                            `9610`=	'DC857',
                                            `9650`=	'DC819',
                                            `9651`=	'DC814',
                                            `9652`=	'DC812',
                                            `9653`=	'DC813',
                                            `9659`=	'DC810',
                                            `9663`=	'DC811',
                                            `9670`=	'DC830',
                                            `9671`=	'DC830B',
                                            `9673`=	'DC831',
                                            `9678`=	'DC838A',
                                            `9679`=	'DC852',
                                            `9680`=	'DC833',
                                            `9687`=	'DC837',
                                            `9689`=	'DC830D',
                                            `968H`=	'DC833',
                                            `968I`=	'DC833',
                                            `9690`=	'DC829',
                                            `9691`=	'DC820',
                                            `9695`=	'DC821',
                                            `9698`=	'DC822',
                                            `9699`=	'DC884',
                                            `9700`=	'DC840',
                                            `9701`=	'DC841',
                                            `9702`=	'DC844',
                                            `9705`=	'DC865',
                                         `9706` = 'DC844E', #CD4+
                                         `9708` = 'DC863', #
                                            `9714`=	'DC846',
                                            `9716`=	'DC861',
                                            `9717`=	'DC862',
                                            `9718`=	'DC866',
                                            `9719`=	'DC860',
                                            `9726`=	'DC844',
                                            `9728`=	'DC835',
                                            `9729`=	'DC835',
                                            `9735`=	'DC833E',
                                            `9737`=	'DC833',
                                            `9827`=	'DC915',
                                            `9970`=	'DC887',
                                            `9971`=	'DC887')) %>% 
    mutate(SUBTYPE_detailed = recode_factor({{snomed}}, 
                                            `9590` = 'NHL_NOS',
                                            `9591`=	'NHL_NOS',
                                            `9610`=	'BCL_NOS',
                                            `9650`=	'cHL_NOS',
                                            `9651`=	'cHL_lr',
                                            `9652`=	'cHL_mc',
                                            `9653`=	'cHL_ld',
                                            `9659`=	'NLP_HL',
                                            `9663`=	'cHL_ns',
                                            `9670`=	'SLL',
                                            `9671`=	'LPL',
                                            `9673`=	'MCL',
                                            `9678`=	'PEL',
                                            `9679`=	'PMBCL',
                                            `9680`=	'DLBCL',
                                            `9687`=	'BL',
                                            `9689`=	'SMZL',
                                            `968H`=	'HGBL',
                                            `968I`=	'HGBL',
                                            `9690`=	'FL_NOS',
                                            `9691`=	'FL1',
                                            `9695`=	'FL2',
                                            `9698`=	'FL3',
                                            `9699`= 'EMZL',
                                            `9700`=	'MF',
                                            `9701`=	'SS',
                                            `9702`=	'PTCL',
                                            `9705`=	'AITL',
                                            `9706` = 'PCCD4TCL', #CD4+
                                            `9708` = 'SPTCL', #DC863
                                            `9714`=	'ALCL',
                                            `9716`=	'HSTCL',
                                            `9717`=	'ITL',
                                            `9718`=	'PCTCL',
                                            `9719`=	'EATL',
                                            `9726`=	'ENKTL-NT',
                                            `9728`=	'LBL',
                                            `9729`=	'LBL',
                                            `9735`=	'PBL',
                                            `9737`=	'ALK+LBCL',
                                            `9827`=	'ATLL',
                                            `9970`=	'PTLD',
                                            `9971`=	'PTLD',
                                            )) 
}
